%File:  CONTALK.LIB  (c)	06/17/80	The Soft Warehouse %

(DEFUN READSENT (LAMBDA (SENTENCE
    WORD)
  (LOOP
    ( ((MEMBER (RATOM) SEPLIS)
	(SETQ WORD (PACK (LIST WORD RATOM (RATOM))))
	(SETQ SENTENCE (CDR SENTENCE)) )
      (SETQ WORD RATOM) )
    ((MEMBER WORD TRMLIS)
      (REVERSE SENTENCE) )
    (SETQ SENTENCE (CONS WORD SENTENCE)) ) ))

(DEFUN PRTSENT (LAMBDA (SENTENCE
    WORD)
  (SETQ PRINT)
  (PRTCAP (CAR SENTENCE))
  (SETQ SENTENCE (CDR SENTENCE))
  (LOOP
    ((NULL SENTENCE)
      (PRIN1 (QUOTE ?)) )
    (SETQ WORD (CAR SENTENCE))
    (SETQ SENTENCE (CDR SENTENCE))
    ((MEMBER WORD TRMLIS)
      (PRIN1 WORD) )
    ( ((OR (NULL SENTENCE) (MEMBER (CAR SENTENCE) TRMLIS)
	(MEMBER (CAR SENTENCE) PCTLIS) )
	  (PRETERPRI WORD) ) )
    ( ((MEMBER WORD PCTLIS))
      (SPACES 1) )
    ( ((MEMBER WORD CAPLIS)
	(PRTCAP WORD) )
      (PRIN1 WORD) ) )
  (SETQ PRINT T) ))

(DEFUN PRTCAP (LAMBDA (WORD)
  ((NUMBERP WORD)
    (PRIN1 WORD) )
  (PRETERPRI WORD)
  (SETQ WORD (UNPACK WORD))
  (SETQ PRINT T)  (PRIN1 (CAR WORD))  (SETQ PRINT)
  (LOOP
    (SETQ WORD (CDR WORD))
    ((NULL WORD))
    (PRIN1 (CAR WORD)) ) ))

(DEFUN PRETERPRI (LAMBDA (WORD)
  ((GREATERP (PLUS (SPACES) (LENGTH WORD))
      (DIFFERENCE (LINELENGTH) 10)		% FOR MULISP79 %
    % (LINELENGTH) %				% FOR MULISP80 %
	)
    (TERPRI) ) ))

(SETQ CAPLIS (I HAWAII))
(SETQ TRMLIS ("." ! ?))
(SETQ PCTLIS ("," ; "(" ")" :))
(SETQ SEPLIS (' -))

(SETQ READ)

STOP
